<!DOCTYPE html>
<html>
<head>
    <title>Speech Emotion Recognition</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<div class="card">
    <h1>üé§ Speech Emotion Recognition</h1>
    <p><b>Unveiling Hidden Factors: Explainable AI for Feature Boosting in Speech Emotion Recognition</b></p>

    <form method="POST" enctype="multipart/form-data">
        <input type="file" name="audio" accept=".wav">
        <button type="submit">Analyze Audio</button>
    </form>

    <hr>

    <button onclick="startRecording()">üéô Start Recording</button>
    <button onclick="stopRecording()">‚èπ Stop Recording</button>

    {% if prediction %}
        <h2>Predicted Emotion</h2>
        <h1 style="color: yellow;">{{ prediction }}</h1>
        <p>Confidence: {{ confidence }}%</p>
    {% endif %}

    {% if human_explanation %}
        <hr>
        <h3>üîç Explainable AI Insight</h3>
        <p>{{ human_explanation }}</p>
    {% endif %}
</div>

<script>
let mediaRecorder;
let audioChunks = [];

function startRecording() {
    navigator.mediaDevices.getUserMedia({ audio: true })
        .then(stream => {
            mediaRecorder = new MediaRecorder(stream);
            mediaRecorder.start();
            audioChunks = [];

            mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
        });
}

function stopRecording() {
    mediaRecorder.stop();
    mediaRecorder.onstop = () => {
        const blob = new Blob(audioChunks, { type: 'audio/wav' });
        const formData = new FormData();
        formData.append('audio', blob, 'recorded.wav');

        fetch('/', {
            method: 'POST',
            body: formData
        }).then(() => location.reload());
    };
}
</script>

</body>
</html>
